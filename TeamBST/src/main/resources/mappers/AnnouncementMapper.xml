<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.itwillbs.mapper.CommunityMapper">

	<!-- Join절 사용하기 위한 resultMap 모두 직접 설정하기 -->
	<resultMap type="com.itwillbs.domain.Post_boardDTO" id="postMap">
		<id property="post_id" column="post_id" />
		<result property="post_writer_id" column="post_writer_id" />
		<result property="post_sub" column="post_sub" />
		<result property="post_cont" column="post_cont" />
		<result property="post_cre_date" column="post_cre_date" />
		<result property="stad_id" column="stad_id" />
		<result property="photo_url" column="photo_url" />
		<result property="post_veiw" column="post_veiw" />
		<result property="sale_status" column="sale_status" />
		<result property="sale_ty" column="sale_ty" />
		<result property="post_del_at" column="post_del_at" />
		<result property="post_del_date" column="post_del_date" />
		<collection property="userList" resultMap="userMap">
		</collection>
	</resultMap>

	<resultMap type="com.itwillbs.domain.UserDTO" id="userMap">
		<result property="user_id" column="user_id" />
		<result property="user_pwd" column="user_pwd" />
		<result property="user_name" column="user_name" />
		<result property="user_nick" column="user_nick" />
		<result property="user_phone" column="user_phone" />
		<result property="user_email" column="user_email" />
		<result property="user_birth" column="user_birth" />
		<result property="join_date" column="join_date" />
		<result property="user_serv_agree" column="user_serv_agree" />
		<result property="user_info_agree" column="user_info_agree" />
		<result property="user_login_time" column="user_login_time" />
		<result property="user_active" column="user_active" />
		<result property="user_status" column="user_status" />
	</resultMap>



	<!-- 거래 게시글 작성 -->
	<insert id="QuestionJoin">
		insert into post_board (post_writer_id, post_sub, post_cont, stad_id, photo_url, sale_ty)
		values ("boo", #{post_sub}, #{post_cont}, #{stad_id}, #{photo_url}, #{sale_ty})
	</insert>

	<!-- 거래 게시글 목록 조회 -->
	<select id="QuestionList" resultMap="postMap">
		select pb.post_sub, pb.post_cre_date, u.user_nick
		from post_board pb join user u
		on pb.post_writer_id = u.user_id
	</select>

</mapper>