<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

  <mapper namespace="com.itwillbs.mapper.ScheduleMapper">

	<!-- 개인 팀 경기 일정 목록 -->
	 <select id="GameSchedule" resultType="com.itwillbs.domain.Game_scheduleDTO">
	 	select * from game_schedule
	 	where (home_team_id=#{name} or away_team_id=#{name})
	 </select> 	 

	<!-- 구장별 경기 일정 목록 -->
	 <select id="TeamSchedule" resultType="com.itwillbs.domain.Game_scheduleDTO">
	 	select * from game_schedule
 		where stad_id = #{stad_id}
	 </select> 	 

	<!-- Join절 사용하기 위한 resultMap 모두 직접 설정하기  -->
	<resultMap type="com.itwillbs.domain.Game_scheduleDTO" id="gameMap">
			<id property="game_id" column="game_id"/>
			<result property="game_id" column="game_id"/>
			<result property="game_date" column="game_date"/>
			<result property="game_time" column="game_time"/>
			<result property="stad_id" column="stad_id"/>
			<result property="home_team_id" column="home_team_id"/>
			<result property="away_team_id" column="away_team_id"/>
			<collection property="teamList" resultMap="teamMap">
		</collection>
	</resultMap>
		
		<resultMap type="com.itwillbs.domain.Team_n_stadiumDTO" id="teamMap">
			<result property="stad_id" column="stad_id" />
			<result property="team_id" column="team_id" />
			<result property="stad_cap" column="stad_cap" />
			<result property="stad_url" column="stad_url" />
			<result property="stad_field_url" column="stad_field_url" />
			<result property="team_logo_url" column="team_logo_url" />
		</resultMap>	


	<!-- 게임고유 번호에 따른 경기 정보 불러오기 -->
		<select id="gameInfo" resultMap="gameMap">
			select gs1.game_id, gs1.game_date, gs1.game_time, gs1.stad_id, gs1.home_team_id, gs1.away_team_id, tns1.stad_url, tns1.stad_field_url, tns1.team_logo_url, tns2.stad_url, tns2.stad_field_url, tns2.team_logo_url
			from (game_schedule gs1 join team_n_stadium tns1
			on gs1.home_team_id = tns1.team_id),
			(game_schedule gs2 join team_n_stadium tns2
			on gs2.away_team_id = tns2.team_id)
			where gs1.game_id = #{game_id} and gs2.game_id = #{game_id}
		</select>
	
	

  
  </mapper>